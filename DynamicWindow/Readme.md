Inspired by Andrew Davidson's DynamicWindow example